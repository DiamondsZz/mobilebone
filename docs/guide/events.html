<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<meta name="description" content="Mobilebone.js 使用教程-中文版-事件" />
<meta name="keywords" content="Mobilebone.js, Mobilebone, 路由, javascript, 使用教程, 事件" />
<meta name="author" content="张鑫旭, zhangxinxu" />
<link rel="icon" href="../assets/favicon.ico">
<title>Mobilebone.js使用教程-事件</title>
<link rel="stylesheet" href="../../src/mobilebone.css">
<link rel="stylesheet" href="../assets/docs.css">
</head>

<body>
<header id="header"></header>
<aside id="aside" href="_aside.html"></aside>
<div class="page out">
	<div class="content">
        <h2>事件</h2>
        <p>先了解 Mobilebone 中与页面生命周期相关的事件。</p>

        <h3>生命周期</h3>

        <p>Mobilebone 中，页面从进入到离开为一个完整的生命周期。</p>
        <p>整个生命周期过程如下图所示，Mobilebone 在生命周期的各个阶段都暴露了接口可以让开发者自定义事件。</p>
        <p style="background-color: #fff; padding:20px; text-align:center;">
            <img src="../assets/mobilebone-lifecircle.svg" width="641" height="1160" alt="Mobilebone生命周期中的事件">
        </p>

        <p>其中：</p>
        <ul>
            <li><code>preventdefault</code> 事件在进入和离开之前都会执行；</li>
            <li><code>onpagefirstinto</code> 事件只会在第1次进入的时候执行；</li>
            <li><code>callback</code> 事件每次页面进入的时候执行；</li>
            <li><code>fallback</code> 事件每次页面离开的时候执行；</li>
            <li><code>animationstart</code> 事件在进入和离开动画执行前都会执行；</li>
            <li><code>onpagefirstinto</code> 事件在进入和离开动画执行后都会执行。</li>
        </ul>
        
        <h3>生命周期事件</h3>
        <p>Mobilebone 中生命周期事件分全局事件和局部事件。</p>
        <p>其中，全局事件使用 Mobilebone 对象直接指定，例如希望所有页面进入的时候都执行，可以这样设置：</p>
        <pre>Mobilebone.callback = function () {
    console.log('每次页面进入都执行');            
};</pre>
        <p>局部事件则通过 <code>data-*</code> 的语法在页面容器元素上设置，例如：</p>
        <pre>&lt;div class="page out" data-callback="someFuncName"&gt;
    &lt;p&gt;页面内容&lt;/p&gt;
&lt;/div&gt;</pre>
        <p>表示该页面进入的时候会执行函数名为<code>someFuncName</code>的方法。在默认状态下，Mobilebone 会在 <code>window</code> 对象中寻找 <code>someFuncName</code> 函数并执行。</p>
        <p>但显然，函数挂载到 <code>window</code> 对象中并不适合复杂的项目，Mobilebone 是支持指定局部函数挂载的对象的，通过 <a href="../api/#&Mobilebone.rootTransition.html" class="link" target="_blank" data-ajax="false">Mobilebone.rootTransition</a> 属性进行设置。</p>

        <p>例如有个 Vue 实例对象 <code>myVue</code>：</p>
        <pre>var myVue = new Vue({
    methods: {
        someFuncName () {}
    }        
});</pre>
        <p>则下面的设置就可以让 Mobilebone 调用 Vue 实例对象中的方法：</p>
        <pre>Mobilebone.rootTransition = myVue;</pre>

        <p>每个生命周期事件都暴露了若干参数，例如：</p>
        <pre>callback(pageIn, pageOut, options);</pre>
        <p>开发者就可以知道当前移入移出的页面是哪个，以及页面间传递的参数是什么（通过 <code>options.query</code> 获取）。</p>
        <p>更多信息可以参见 API 文档中的：<a href="../api/#&data-callbackKeys.html" class="link" target="_blank" data-ajax="false">Mobilebone.rootTransition</a></p>

        <h3>页面事件</h3>
        <p></p>

        <hr>
        <p>发现错误？想参与编辑？在 <a href="https://github.com/zhangxinxu/mobilebone/blob/master/docs/guide/install.html" class="link" target="_blank" rel="nooppener">GitHub 上编辑此页</a>！</p>
    </div>
</div>

<script src="nav.js"></script>
<script src="../../src/mobilebone.js"></script>
<script>
Mobilebone.captureLink = false;
window.navKey = "install";
</script>
<script src="../assets/docs.js"></script>
<!-- ga统计 -->
<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-11205167-1']);
_gaq.push(['_trackPageview']);
(function() {
    if (location.host == 'www.zhangxinxu.com') {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    }
})();
</script>
</body>
</html>
